var SpeechToTextService;(function(n){function wt(n,t,i,r){var f=function(r){r.some(function(r){var u=!1;return r.kind===st&&(ft(t,i,n),u=!0),u})},u;r?ft(t,i,n):navigator&&navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&(u=navigator.mediaDevices.enumerateDevices(),u&&u.then&&u.then(f)["catch"](function(){translationClientInst.sLog(ht)}))}function ft(n,t,r){(s=transDom.input.micIcon,u=transDom.input.micIconContainer,i=transDom.input.textArea,rt=transDom.input.editInputTextElement,a=transDom.output.textArea,v=transDom.input.asBoxPrefixElement,y=transDom.input.asBox,p=transDom.input.transliterateBox,w=transDom.output.transliterateBox,b=transDom.input.langSelect,ut=i.getAttribute("placeholder"),s&&u&&i&&a&&v&&y&&p&&w&&b)&&(g=n,nt=t,tt=r,et(c),sj_be(s,"click",d),sj_be(s,"keyup",function(n){n.keyCode===RichTranslateHelper.enterKeyCode&&d()}),sj_evt.bind(RichTranslateHelper.stopSpeechListen,k),sj_evt.bind(RichTranslateHelper.sourceLangChanged,function(n){c=n&&n.length>1?n[1]:"";et(c)},!0),it=AudioConfig.fromDefaultMicrophoneInput())}function bt(){RichTranslateHelper.hideElement(transDom.input.playIconContainer)}function kt(){RichTranslateHelper.hideElement(transDom.revIcon)}function dt(){RichTranslateHelper.showElement(transDom.revIcon)}function gt(){RichTranslateHelper.hideElement(transDom.output.outputControl)}function ni(){transDom.output.textArea.value&&RichTranslateHelper.showElement(transDom.output.outputControl)}function ti(){RichTranslateHelper.hideElement(transDom.input.relTranslationsContainer)}function ii(){RichTranslateHelper.hideElement(transDom.expansionCtrl.expansionControl)}function ri(){RichTranslateHelper.showElement(transDom.expansionCtrl.noExpansionCreditLinkContainer)}function et(n){n===void 0&&(n="");var t=ui(n);t?(RichTranslateHelper.showElement(u),h=t):(RichTranslateHelper.hideElement(u),h="")}function ui(n){var t=b.value;if(t==="auto-detect")if(n)t=n;else if(tt)return g;return SpeechServiceHelper.mapSelectedLanguageToVoiceInputLanguageCode(t)}function f(){t&&(t.close(),t=undefined);ot()}function ot(){sa_cl(u,"tta_playfocus",!1);i.setAttribute("placeholder",ut);dt();ni()}function k(){t&&(t.stopContinuousRecognitionAsync(function(){f()},function(n){translationClientInst.log(pt,"L",e(r),"err",n);f()}),sj_evt.fire(RichTranslateHelper.micInputEndEvent),ot())}function e(n){return Date.now()-n+""}function d(){if(t){k();translatorTel.logEvent(TranslatorWebTelemetry.EventScope.Mic_Event,"Mic button clicked",{ux_action:"MicButtonClickedToStopSpeech"});return}translatorTel.logEvent(TranslatorWebTelemetry.EventScope.Mic_Event,"Mic button clicked",{ux_action:"MicButtonClickedToStartSpeech"});r=Date.now();SpeechServiceHelper.validTokenpresent?(l=SpeechConfig.fromAuthorizationToken(SpeechServiceHelper.authToken,SpeechServiceHelper.regionKey),l.speechRecognitionLanguage=h,t=new SpeechRecognizer(l,it),t.sessionStarted=function(){sa_cl(u,"tta_playfocus",!0);RichTranslateHelper.updateTextArea(i,"");RichTranslateHelper.updateTextArea(a,"");RichTranslateHelper.clearElementInnerText(rt);RichTranslateHelper.clearElementInnerText(v);RichTranslateHelper.clearElementInnerText(y);RichTranslateHelper.clearElementInnerText(p);RichTranslateHelper.clearElementInnerText(w);kt();bt();gt();ti();ii();sj_evt.fire(RichTranslateHelper.micInputStartedEvent);ri();i.setAttribute("placeholder",nt);translationClientInst.log(ct,"L",e(r),o,transDom.input.langSelect.value)},t.sessionStopped=function(){translationClientInst.log(lt,"L",e(r),o,transDom.input.langSelect.value);f()},t.speechStartDetected=function(){},t.speechEndDetected=function(){f()},t.canceled=function(){f();translationClientInst.log(vt,"L",e(r),o,transDom.input.langSelect.value)},t.recognizing=function(n,t){RichTranslateHelper.updateTextArea(i,t.result.text);sj_evt.fire(RichTranslateHelper.micInputListeningEvent)},t.recognized=function(n,t){t.result.text&&RichTranslateHelper.updateTextArea(i,t.result.text);translationClientInst.log(at,"L",e(r),o,transDom.input.langSelect.value);k()},t.startContinuousRecognitionAsync(function(){},function(){translationClientInst.log(yt,"L",e(r),o,transDom.input.langSelect.value);f()})):SpeechServiceHelper.fetchOrUpdateSpeechAuthTokenOnDemand(function(){d()},function(){})}var st="audioinput",ht="NoMicSupport",ct="SpeechStart",lt="SpeechEnd",at="SpeechRecognized",vt="SpeechCancel",yt="SpeechStartError",pt="SpeechStopError",o="SpeechLang",g,h="",nt,c="",tt,it,l,t,r,s,u,i,rt,a,v,y,p,w,b,ut;n.verifyAudioInputSupportAndInitialize=wt;sj_evt.fire("speechRecognizerLoaded")})(SpeechToTextService||(SpeechToTextService={}))