!function(n,t){var i,r;if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{i=t();for(r in i)("object"==typeof exports?exports:n)[r]=i[r]}}(this,function(){return function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={exports:{},id:r,loaded:!1};return n[r].call(u.exports,u,u.exports,t),u.loaded=!0,u.exports}var i={};return t.m=n,t.c=i,t.p="",t(0)}([function(n,t,i){n.exports=i(1)},function(n,t,i){"use strict";var u=i(2),r;t.AWTPiiKind=u.AWTPiiKind;r=i(3);t.AWT=r["default"];t.AWT_COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/";t.AWT_COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/";t.AWT_COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/";t.AWT_COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/";t.AWT_COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/"},function(n,t){"use strict";var i;!function(n){n[n.NotSet=0]="NotSet";n[n.DistinguishedName=1]="DistinguishedName";n[n.GenericData=2]="GenericData";n[n.IPV4Address=3]="IPV4Address";n[n.IPv6Address=4]="IPv6Address";n[n.MailSubject=5]="MailSubject";n[n.PhoneNumber=6]="PhoneNumber";n[n.QueryString=7]="QueryString";n[n.SipAddress=8]="SipAddress";n[n.SmtpAddress=9]="SmtpAddress";n[n.Identity=10]="Identity";n[n.Uri=11]="Uri";n[n.Fqdn=12]="Fqdn";n[n.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(i=t.AWTPiiKind||(t.AWTPiiKind={}))},function(n,t,i){"use strict";var e=i(2),u=i(4),f=i(12),h=i(15),o="allTkns",s=/^[a-zA-Z0-9]([a-zA-Z0-9]|_|\.){2,98}[a-zA-Z0-9]$/,c=/\./g,l=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,r=function(){function n(){}return n.initialize=function(n,t){if(void 0===t&&(t={}),this._isInitialized)throw"Already Initialized";this._defaultTenantToken=n;this._overrideValuesFromConfig(t);u["default"].initialize(this._config);this._isInitialized=!0},n.flush=function(n){this._isInitialized&&!this._isDestroyed&&u["default"].flush(n)},n.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._isDestroyed=!0,u["default"].flushAndTeardown())},n.setContext=function(n,t,i){void 0===i&&(i=o);t=this._sanitizeProperty(n,t);null!==t&&(this._contextProperties[i]||(this._contextProperties[i]={}),this._contextProperties[i][n]=t)},n.logEvent=function(n){var i=this,t;if(this._isInitialized){if(!n.name||!n.properties)return;if(n.name=n.name.toLowerCase(),n.name.replace(c,"_"),t="",n.type?(n.type.toLowerCase(),t="custom."):n.type="custom",!s.test(n.name)||!s.test(n.type))return;if(n.type=t+n.type,isNaN(n.timestamp)&&(n.timestamp=(new Date).getTime()),n.tenantToken||(n.tenantToken=this._defaultTenantToken),n.id=f.newGuid(),Object.keys(n.properties).forEach(function(t){n.properties[t]=i._sanitizeProperty(t,n.properties[t]);null===n.properties[t]&&delete n.properties[t]}),this._addContextIfAbsent(n,n.tenantToken),this._addContextIfAbsent(n,o),0===Object.keys(n.properties).length)return;this._setDefaultProperty(n,"EventInfo.InitId",this._getInitId(n.tenantToken));this._setDefaultProperty(n,"EventInfo.Sequence",this._getSequenceId(n.tenantToken));this._setDefaultProperty(n,"EventInfo.SdkVersion",h.FullVersionString);this._setDefaultProperty(n,"EventInfo.Name",n.name);this._setDefaultProperty(n,"EventInfo.Time",new Date(n.timestamp).toISOString());u["default"].sendEvent(n)}},n._overrideValuesFromConfig=function(n){n.collectorUrl&&(this._config.collectorUrl=n.collectorUrl);n.sendingTimer>1e3&&(this._config.sendingTimer=n.sendingTimer)},n._getInitId=function(n){return void 0===this._initIdMap[n]&&(this._initIdMap[n]=f.newGuid()),this._initIdMap[n]},n._getSequenceId=function(n){return void 0===this._sequenceIdMap[n]&&(this._sequenceIdMap[n]=0),(++this._sequenceIdMap[n]).toString()},n._setDefaultProperty=function(n,t,i){n.properties[t]={value:i,pii:e.AWTPiiKind.NotSet}},n._addContextIfAbsent=function(n,t){if(this._contextProperties[t]){var i=this._contextProperties[t];Object.keys(i).forEach(function(t){n.properties[t]||(n.properties[t]=i[t])})}},n._sanitizeProperty=function(n,t){return"string"!=typeof t&&"number"!=typeof t&&"boolean"!=typeof t||(t={value:t}),l.test(n)&&void 0!==t&&null!==t&&null!==t.value&&void 0!==t.value&&""!==t.value?("undefined"==typeof t.pii&&(t.pii=e.AWTPiiKind.NotSet),t.value=t.value.toString(),f.isPii(t.pii)?t:null):null},n}();r._isInitialized=!1;r._isDestroyed=!1;r._contextProperties={};r._sequenceIdMap={};r._initIdMap={};r._config={collectorUrl:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",sendingTimer:1e3};Object.defineProperty(t,"__esModule",{value:!0});t["default"]=r},function(n,t,i){"use strict";var o=i(5),u=i(6),f=i(13),s=i(14),h=i(15),e=250,c=2936012,l=4,r=function(){function n(){}return n.initialize=function(n){this._inboundQueues.push([]);this._recordBatcher=new o["default"](c,this._outboundQueue);this._newEventsAllowed=!0;"undefined"==typeof Uint8Array&&(this._urlString+="&content-encoding=base64");this._sendingTimer=n.sendingTimer;this._urlString=n.collectorUrl+this._urlString+"&x-apikey="},n.sendEvent=function(n){var t=this;this._newEventsAllowed&&(this._inboundQueues[this._inboundQueues.length-1].push(n),!this._running&&this._timeout<0&&!this._isCurrentlyFlushing&&(this._timeout=setTimeout(function(){return t._batchAndSendEvents(!1)},this._sendingTimer)))},n.flushAndTeardown=function(){this._newEventsAllowed=!1;this._batchAndSendEvents(!0)},n.flush=function(n){this._inboundQueues.push([]);this._isCurrentlyFlushing?this._flushQueue.push(n):(this._isCurrentlyFlushing=!0,this._flush(n))},n._batchAndSendEvents=function(n){for(this._running=!0;this._inboundQueues[0].length>0&&this._outboundQueue.length<1;)this._recordBatcher.addEventToBatch(this._inboundQueues[0].pop());0===this._outboundQueue.length&&this._recordBatcher.flushBatch();this._sendRequest(this._outboundQueue.pop(),0,n)},n._retryRequestIfNeeded=function(n,t,i,r,u){var s=this,e=!0,o;n&&"undefined"!=typeof n.status&&(o=this._killSwitch.setKillSwitchTenants(n.getResponseHeader("kill-tokens"),n.getResponseHeader("kill-duration-seconds")),o.forEach(function(n){delete t[n];i--}),(!f["default"].shouldRetryForStatus(n.status)||i<=0)&&(e=!1));e&&u<l?setTimeout(function(){return s._sendRequest(t,u+1,!1)},f["default"].getMillisToBackoffForRetry(u)):this._handleRequestFinished(null)},n._sendRequest=function(n,t,i){var o=this,r=new XMLHttpRequest,e=0,f="",s;(Object.keys(n).forEach(function(t){o._killSwitch.isTenantKilled(t)?delete n[t]:(f.length>0&&(f+=","),f+=t,e++)}),r.open("POST",this._urlString+f,!i),i||(r.ontimeout=function(){o._retryRequestIfNeeded(r,n,e,f,t)},r.onerror=function(){o._retryRequestIfNeeded(r,n,e,f,t)},r.onload=function(){o._handleRequestFinished(r)}),e>0)?(s=u["default"].getPayloadBlob(n,e),"undefined"==typeof Uint8Array?r.send(u["default"].base64Encode(s)):r.send(new Uint8Array(s))):i&&this._handleRequestFinished(null)},n._handleRequestFinished=function(n){var t=this;n&&this._killSwitch.setKillSwitchTenants(n.getResponseHeader("kill-tokens"),n.getResponseHeader("kill-duration-seconds"));this._inboundQueues[0].length>0?this._timeout=setTimeout(function(){return t._batchAndSendEvents(!1)},this._sendingTimer):(this._timeout=-1,this._running=!1)},n._flush=function(n){var t=this;this._running||(this._timeout>-1&&(clearTimeout(this._timeout),this._timeout=-1),this._inboundQueues[0].length>0&&this._batchAndSendEvents(!1));this._checkPrimaryInboundQueueEmpty(function(){t._inboundQueues.shift();null!==n&&void 0!==n&&n();t._flushQueue.length>0?setTimeout(function(){return t._flush(t._flushQueue.shift())},t._sendingTimer):(t._isCurrentlyFlushing=!1,t._inboundQueues[0].length>0&&(t._timeout=setTimeout(function(){return t._batchAndSendEvents(!1)},t._sendingTimer)))})},n._checkPrimaryInboundQueueEmpty=function(n){var t=this;0===this._inboundQueues[0].length?this._checkOutboundQueueEmptyAndSent(n):setTimeout(function(){return t._checkPrimaryInboundQueueEmpty(n)},e)},n._checkOutboundQueueEmptyAndSent=function(n){var t=this;this._running?setTimeout(function(){return t._checkOutboundQueueEmptyAndSent(n)},e):n()},n}();r._outboundQueue=[];r._inboundQueues=[];r._newEventsAllowed=!1;r._killSwitch=new s["default"];r._isCurrentlyFlushing=!1;r._flushQueue=[];r._running=!1;r._timeout=-1;r._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+h.FullVersionString;Object.defineProperty(t,"__esModule",{value:!0});t["default"]=r},function(n,t,i){"use strict";var r=i(6),u=function(){function n(n,t){this._maxRequestSize=n;this._outboundQueue=t;this._currentBatch={};this._currentBatchSize=0}return n.prototype.addEventToBatch=function(n){var t=r["default"].getEventBlob(n);t.length>this._maxRequestSize||(this._currentBatchSize+t.length>this._maxRequestSize?this.flushBatch():(void 0===this._currentBatch[n.tenantToken]&&(this._currentBatch[n.tenantToken]=[]),this._currentBatch[n.tenantToken].push(t),this._currentBatchSize+=t.length))},n.prototype.flushBatch=function(){this._currentBatchSize>0&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentBatchSize=0)},n}();Object.defineProperty(t,"__esModule",{value:!0});t["default"]=u},function(n,t,i){"use strict";var r=i(7),f=i(2),u=i(12),e=function(){function n(){}return n.getPayloadBlob=function(n,t){var f=new r.IO.MemoryStream,i=new r.CompactBinaryProtocolWriter(f);return i.WriteFieldBegin(r.BondDataType.BT_MAP,3),i.WriteMapContainerBegin(t,r.BondDataType.BT_STRING,r.BondDataType.BT_LIST),Object.keys(n).forEach(function(t){var f,e;for(i.WriteString(t),f=n[t],i.WriteContainerBegin(1,r.BondDataType.BT_STRUCT),i.WriteFieldBegin(r.BondDataType.BT_STRING,2),i.WriteString("act_default_source"),i.WriteFieldBegin(r.BondDataType.BT_STRING,5),i.WriteString(u.newGuid()),i.WriteFieldBegin(r.BondDataType.BT_INT64,6),i.WriteInt64(u.numberToBondInt64(Date.now())),i.WriteFieldBegin(r.BondDataType.BT_LIST,8),i.WriteContainerBegin(f.length,r.BondDataType.BT_STRUCT),e=0;e<f.length;++e)i.WriteBlob(f[e]);i.WriteStructEnd(!1)}),i.WriteStructEnd(!1),f.GetBuffer()},n.getEventBlob=function(n){var o=new r.IO.MemoryStream,t=new r.CompactBinaryProtocolWriter(o),i,e;return t.WriteFieldBegin(r.BondDataType.BT_STRING,1),t.WriteString(n.id),t.WriteFieldBegin(r.BondDataType.BT_INT64,3),t.WriteInt64(u.numberToBondInt64(n.timestamp)),t.WriteFieldBegin(r.BondDataType.BT_STRING,5),t.WriteString(n.type),t.WriteFieldBegin(r.BondDataType.BT_STRING,6),t.WriteString(n.name),i=[],e=[],Object.keys(n.properties).forEach(function(t){var r=n.properties[t];r.pii===f.AWTPiiKind.NotSet?i.push(t):e.push(t)}),i.length&&(t.WriteFieldBegin(r.BondDataType.BT_MAP,13),t.WriteMapContainerBegin(i.length,r.BondDataType.BT_STRING,r.BondDataType.BT_STRING),i.forEach(function(i){t.WriteString(i);t.WriteString(n.properties[i].value)})),e.length&&(t.WriteFieldBegin(r.BondDataType.BT_MAP,30),t.WriteMapContainerBegin(e.length,r.BondDataType.BT_STRING,r.BondDataType.BT_STRUCT),e.forEach(function(i){t.WriteString(i);t.WriteFieldBegin(r.BondDataType.BT_INT32,1);t.WriteInt32(1);t.WriteFieldBegin(r.BondDataType.BT_INT32,2);t.WriteInt32(n.properties[i].pii);t.WriteFieldBegin(r.BondDataType.BT_STRING,3);t.WriteString(n.properties[i].value);t.WriteStructEnd(!1)})),t.WriteStructEnd(!1),o.GetBuffer()},n.base64Encode=function(n){return r.Encoding.Base64.GetString(n)},n}();Object.defineProperty(t,"__esModule",{value:!0});t["default"]=e},function(n,t,i){"use strict";var f=i(8),r,e,u,o;t.BondDataType=f.BondDataType;r=i(9);t.Encoding=r;e=i(11);t.IO=e;u=i(10);t.Int64=u.Int64;t.UInt64=u.UInt64;t.Number=u.Number;o=function(){function n(n){this._stream=n}return n.prototype.WriteBlob=function(n){this._stream.Write(n,0,n.length)},n.prototype.WriteContainerBegin=function(n,t){this.WriteUInt8(t);this.WriteUInt32(n)},n.prototype.WriteMapContainerBegin=function(n,t,i){this.WriteUInt8(t);this.WriteUInt8(i);this.WriteUInt32(n)},n.prototype.WriteFieldBegin=function(n,t){t<=5?this._stream.WriteByte(n|t<<5):t<=255?(this._stream.WriteByte(192|n),this._stream.WriteByte(t)):(this._stream.WriteByte(224|n),this._stream.WriteByte(t),this._stream.WriteByte(t>>8))},n.prototype.WriteInt32=function(n){n=r.Zigzag.EncodeZigzag32(n);this.WriteUInt32(n)},n.prototype.WriteInt64=function(n){this.WriteUInt64(r.Zigzag.EncodeZigzag64(n))},n.prototype.WriteString=function(n){if(""===n)this.WriteUInt32(0);else{var t=r.Utf8.GetBytes(n);this.WriteUInt32(t.length);this._stream.Write(t,0,t.length)}},n.prototype.WriteStructEnd=function(n){this.WriteUInt8(n?f.BondDataType.BT_STOP_BASE:f.BondDataType.BT_STOP)},n.prototype.WriteUInt32=function(n){var t=r.Varint.GetBytes(u.Number.ToUInt32(n));this._stream.Write(t,0,t.length)},n.prototype.WriteUInt64=function(n){var t=r.Varint64.GetBytes(n);this._stream.Write(t,0,t.length)},n.prototype.WriteUInt8=function(n){this._stream.WriteByte(u.Number.ToUInt8(n))},n}();t.CompactBinaryProtocolWriter=o},function(n,t){"use strict";var i;!function(n){n[n.BT_STOP=0]="BT_STOP";n[n.BT_STOP_BASE=1]="BT_STOP_BASE";n[n.BT_UINT8=3]="BT_UINT8";n[n.BT_UINT32=5]="BT_UINT32";n[n.BT_UINT64=6]="BT_UINT64";n[n.BT_STRING=9]="BT_STRING";n[n.BT_STRUCT=10]="BT_STRUCT";n[n.BT_LIST=11]="BT_LIST";n[n.BT_MAP=13]="BT_MAP";n[n.BT_INT32=16]="BT_INT32";n[n.BT_INT64=17]="BT_INT64";n[n.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"}(i=t.BondDataType||(t.BondDataType={}))},function(n,t,i){"use strict";var r=i(10),s=function(){function n(){}return n.GetBytes=function(n){for(var t,i=[],r=0;r<n.length;++r)t=n.charCodeAt(r),t<128?i.push(t):t<2048?i.push(192|t>>6,128|63&t):t<55296||t>=57344?i.push(224|t>>12,128|t>>6&63,128|63&t):(t=65536+((1023&t)<<10|1023&n.charCodeAt(++r)),i.push(240|t>>18,128|t>>12&63,128|t>>6&63,128|63&t));return i},n}(),u,f,e,o;t.Utf8=s;u=function(){function n(){}return n.GetString=function(n){for(var u,f,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=[],e=n.length%3,o=function(n){return[t.charAt(n>>18&63),t.charAt(n>>12&63),t.charAt(n>>6&63),t.charAt(63&n)].join("")},r=0,s=n.length-e;r<s;r+=3)u=(n[r]<<16)+(n[r+1]<<8)+n[r+2],i.push(o(u));switch(e){case 1:u=n[n.length-1];i.push(t.charAt(u>>2));i.push(t.charAt(u<<4&63));i.push("==");break;case 2:f=(n[n.length-2]<<8)+n[n.length-1];i.push(t.charAt(f>>10));i.push(t.charAt(f>>4&63));i.push(t.charAt(f<<2&63));i.push("=")}return i.join("")},n}();t.Base64=u;f=function(){function n(){}return n.GetBytes=function(n){for(var t=[];4294967168&n;)t.push(127&n|128),n>>>=7;return t.push(127&n),t},n}();t.Varint=f;e=function(){function n(){}return n.GetBytes=function(n){for(var t=n.low,i=n.high,r=[];i||4294967168&t;)r.push(127&t|128),t=(127&i)<<25|t>>>7,i>>>=7;return r.push(127&t),r},n}();t.Varint64=e;o=function(){function n(){}return n.EncodeZigzag32=function(n){return n=r.Number.ToInt32(n),n<<1^n>>31},n.EncodeZigzag64=function(n){var f=n.low,e=n.high,i=e<<1|f>>>31,u=f<<1,t;return 2147483648&e&&(i=~i,u=~u),t=new r.UInt64("0"),t.low=u,t.high=i,t},n}();t.Zigzag=o},function(n,t){"use strict";var u=function(){function n(n){this.low=0;this.high=0;this.low=parseInt(n,10);this.low<0&&(this.high=-1)}return n.prototype.Equals=function(t){var i=new n(t);return this.low===i.low&&this.high===i.high},n}(),i,r;t.Int64=u;i=function(){function n(n){this.low=0;this.high=0;this.low=parseInt(n,10)}return n.prototype.Equals=function(t){var i=new n(t);return this.low===i.low&&this.high===i.high},n}();t.UInt64=i;r=function(){function n(){}return n.ToByte=function(n){return this.ToUInt8(n)},n.ToInt16=function(n){var t=(32768&n)<<16>>16;return 32767&n|t},n.ToInt32=function(n){var t=2147483648&n;return 2147483647&n|t},n.ToUInt8=function(n){return 255&n},n.ToUInt32=function(n){return 4294967295&n},n}();t.Number=r},function(n,t,i){"use strict";var r=i(10),u=function(){function n(){this._buffer=[]}return n.prototype.WriteByte=function(n){this._buffer.push(r.Number.ToByte(n))},n.prototype.Write=function(n,t,i){for(;i--;)this.WriteByte(n[t++])},n.prototype.GetBuffer=function(){return this._buffer},n}();t.MemoryStream=u},function(n,t,i){"use strict";function r(n){var t=new e.Int64("0");return t.low=4294967295&n,t.high=Math.floor(n/4294967296),t}function u(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(o,function(n){var t=16*Math.random()|0,i="x"===n?t:3&t|8;return i.toString(16)})}function f(n){return!isNaN(n)&&null!==n&&n>=0&&n<=13}var e=i(10),o=/[xy]/g;t.numberToBondInt64=r;t.newGuid=u;t.isPii=f},function(n,t){"use strict";var r=.8,u=1.2,i=3e3,f=12e4,e=function(){function n(){}return n.shouldRetryForStatus=function(n){return!(n>=300&&n<500&&408!==n||501===n||505===n)},n.getMillisToBackoffForRetry=function(n){var t=0,e=i*r,o=i*u,s=Math.floor(Math.random()*(o-e))+e;return t=Math.pow(4,n)*s,Math.min(t,f)},n}();Object.defineProperty(t,"__esModule",{value:!0});t["default"]=e},function(n,t){"use strict";var i=1e3,r=function(){function n(){this._killedTokenDictionary={}}return n.prototype.setKillSwitchTenants=function(n,t){var f=this,r,u;if(n&&t)try{if(r=n.split(","),"this-request-only"===t)return r;u=parseInt(t,10)*i;r.forEach(function(n){f._killedTokenDictionary[n]=Date.now()+u})}catch(e){return[]}return[]},n.prototype.isTenantKilled=function(n){return void 0!==this._killedTokenDictionary[n]&&this._killedTokenDictionary[n]>Date.now()||(delete this._killedTokenDictionary[n],!1)},n}();Object.defineProperty(t,"__esModule",{value:!0});t["default"]=r},function(n,t){"use strict";t.Version="1.2.0";t.FullVersionString="AWT-Web-CJS-"+t.Version}])})