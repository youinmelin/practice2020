var TextToSpeechService;(function(n){function b(i,r,f,e,h,a){s=r;o=i;u=f;n.maximumCharacterSupport=e;c=h;l=a;t=_d.createElement("audio");a&&_d.body.appendChild(t)}function k(n){return n&&u&&u.indexOf(n)!=-1}function d(n,t,u,o,s,c,l){if(c===void 0&&(c=SpeechServiceHelper.emptyFunction),l===void 0&&(l=SpeechServiceHelper.emptyFunction),(!n||!t||!s||!u||!o||i)&&(a(),s==h)){translatorTel.logEvent(TranslatorWebTelemetry.EventScope.Audio_Event,"Audio Pause",{ux_action:"Pause",audioSide:r(s)});translationClientInst.log(y,e,r(s));return}translationClientInst.log(p,e,r(s));translatorTel.logEvent(TranslatorWebTelemetry.EventScope.Audio_Event,"Audio Play",{ux_action:"Play",audioSide:r(s)});h=s;f=l;sj_evt.fire(RichTranslateHelper.stopSpeechListen);n.length>1e3&&(n=n.slice(0,1e3));SpeechServiceHelper.validTokenpresent?v(n,t,u,o,SpeechServiceHelper.regionKey,SpeechServiceHelper.authToken,c,l):SpeechServiceHelper.fetchOrUpdateSpeechAuthTokenOnDemand(function(){v(n,t,u,o,SpeechServiceHelper.regionKey,SpeechServiceHelper.authToken,c,l)},function(){})}function a(){t.pause();i=!1;t.src="";f();t.onended=function(){}}function r(n){return n==transDom.input.playIcon?"Input":n==transDom.output.playIcon?"Output":"AlternateTranslations"}function v(n,r,u,f,e,h,a,v){a===void 0&&(a=SpeechServiceHelper.emptyFunction);v===void 0&&(v=SpeechServiceHelper.emptyFunction);var p="<speak version='1.0' xml:lang='"+r+"'><voice xml:lang='"+r+"' xml:gender='"+u+"' name='"+f+"'><prosody rate='"+c+"'>"+n+"<\/prosody><\/voice><\/speak>",y=sj_gx();y.open("POST",RichTranslateHelper.stringFormat(o,e));y.setRequestHeader("Content-Type",w);y.setRequestHeader("Authorization","Bearer "+h);y.setRequestHeader("X-MICROSOFT-OutputFormat",s);y.setRequestHeader("cache-control","no-cache");y.responseType="arraybuffer";y.onreadystatechange=function(){y.readyState===4&&y.status===200&&y.response&&(a(),i=!0,t.src="data:audio/mp3;base64,"+SpeechServiceHelper.arrayBufferToBase64(y.response),l||t.load(),t.play(),t.onended=function(){i=!1;v()})};y.send(p)}var y="PauseAudio",p="PlayAudio",e="AudioSource",w="application/ssml+xml",i,o,s,u,h,f,t,c,l;n.maximumCharacterSupport=1e3;i=!1;f=SpeechServiceHelper.emptyFunction;n.init=b;n.isAudioLanguageSupported=k;n.playOrStopAudio=d;n.resetAudioControl=a})(TextToSpeechService||(TextToSpeechService={}))